<div class="reservas-container">
  <h2 class="dashboard-title">Reservas</h2>
  <div class="kpi-cards">
    <mat-card class="kpi-card">
      <mat-icon>event_available</mat-icon>
      <span class="kpi-value">{{ totalReservas }}</span>
      <span class="kpi-label">Total</span>
    </mat-card>
    <mat-card class="kpi-card">
      <mat-icon>check_circle</mat-icon>
      <span class="kpi-value">{{ reservasAtivas }}</span>
      <span class="kpi-label">Ativas</span>
    </mat-card>
    <mat-card class="kpi-card">
      <mat-icon color="warn">cancel</mat-icon>
      <span class="kpi-value">{{ reservasCanceladas }}</span>
      <span class="kpi-label">Canceladas</span>
      <span class="kpi-sub" [ngClass]="{ 'warn-text': true }">
        {{ percentualCanceladas | number : '1.0-2' }}%
      </span>
    </mat-card>
  </div>

  <div class="reservas-list" *ngIf="reservas.length">
    <div *ngFor="let reserva of reservas" class="reserva-card">
      <div class="reserva-head">
        <span class="reserva-mesa"
          ><strong>Mesa:</strong> {{ mesas.get(reserva.idMesa) || reserva.idMesa }}</span
        >
        <span
          class="reserva-status"
          [ngClass]="{
            ativa: getStatus(reserva) === 'Ativa',
            concluida: getStatus(reserva) === 'Concluída',
            cancelada: getStatus(reserva) === 'Cancelada'
          }"
        >
          {{ getStatus(reserva) }}
        </span>
      </div>
      <hr />
      <div class="reserva-details">
        <div><strong>Dia:</strong> {{ reserva.data | date : 'dd/MM/yyyy' }}</div>
        <div>
          <strong>Horário:</strong> {{ horarios.get(reserva.idHorario) || reserva.idHorario }}
        </div>
        <div><strong>Criada em:</strong> {{ timestampToDate(reserva.createdAt) }}</div>
        <div>
          <strong>Usuário: {{ reserva.usuario }}</strong>
        </div>
      </div>
    </div>
  </div>
</div>
